library(ggman)
head(gwas)
ggman(gwas, snp = "SNP1")
ggman(gwas1)
library(ggman)
check.input.ggman
ggman(gwas, snp = "SNP1")
detach("package:ggman", unload=T)
library(ggman)
ggman(gwas, snp = "SNP1")
f2()
f2()
f2()
library(ggman)
ggman(gwas,snp="SNP1")
ggman(gwas = gwas1,snp="SNP1")
a = list()
ggman(gwas = a,snp="SNP1")
ggman(gwas = a,lineColor = "hello")
ggman(gwas ,lineColor = "hello")
ggman(gwas ,snp = "SNP", bp = "BP", chrom = "CHR", pvalue = "P",lineColor = "hello")
ggman(gwas ,snp = "SNP", bp = "BP", chrom = "CHR", pvalue = "P",ylabel = 1)
ls()
p1 <- ggman(gwas, snp = "SNP", bp = "BP", chrom = "CHROM", pvalue = "P")
p1 <- ggman(gwas, snp = "SNP", bp = "BP", chrom = "CHR", pvalue = "P")
library(ggman)
p1 <- ggman(gwas, snp = "SNP", bp = "BP", chrom = "CHR", pvalue = "P")
p1
class(p1)
ggmanLabel(p1)
ggmanLabel(p1)
gwas.sig <- gwas[-log10(gwas$P) >8,]
head(gwas.sig)
ggmanLabel(p1,labelDfm = gwas.sig)
ggmanLabel(p1,labelDfm = gwas.sig)
get(gwas.sig)
get(gwas.sig)
deparse(substitute(gwas.sig))
ggmanLabel(p1,labelDfm = gwas.sig)
ggmanLabel(p1,labelDfm = gwas.sig)
ggmanLabel(p1,labelDfm = gwas.sig, snp = "SNP1")
ggmanLabel(p1,labelDfm = gwas.sig, snp = "SNP")
names(gwasSig)
names(gwas.sig)
ggmanLabel(p1,labelDfm = gwas.sig, snp = "SNP")
ggmanLabel(p1,labelDfm = gwas.sig, snp = "SNP", label = "SNP",type="hello")
temp = data.frame(snp = c("rs88888"))
temp
ggmanLabel(p1,temp,snp="snp")
ggmanLabel(p1,labelDfm = gwas.sig, snp = "SNP", label = "SNP")
ggmanLabel(p1,labelDfm = gwas.sig, snp = "SNP", label = "SNP")
library(ggman)
ggmanLabel(p1,labelDfm = gwas.sig, snp = "SNP", label = "SNP")
ggmanLabel(p1,labelDfm = gwas.sig, snp = "SNP", label = paste0(CHR,":",BP))
ggmanLabel(p1,labelDfm = gwas.sig, snp = "SNP", label = "BP")
p1
names(p1)
p1$scales
p1$mapping
p1$theme
p1$facet
names(p1)
p1$plot_env
p1$guides
ggmanLabel(p1,labelDfm = gwas.sig, snp = "SNP", label = "BP")
ggmanHighlight(p1,highlights)
ggmanHighlight(p1,highlights)
ggmanHighlight(p1,highlights,colour="green")
ggmanHighlight(p1,highlights,colour="green", size = 0.1)
ggmanHighlight(p1,highlights,colour="green", size = 0.1)
is.vector
a = c(1,2,3)
a
is.vector(a)
b = c("A","B","C")
b
is.vector(b)
class(b)
class(a)
ls()
temp
ggmanHighlight(p1,highlight = c("rsaaaa"))
ggmanHighlight(p1,highlight = c("rsaaaa"))
ggmanHighlight(p1,highlight = c("rsaaaa"))
ls()
temp <- gwas.sig[gwas.sig$SNP %in% c("rsaaa"),]
temp
nrow(temp)
ggmanHighlight(p1,highlight = c("rsaaaa"))
ggmanHighlight(p1,highlights,colour="a"
)
ggmanHighlight(p1,highlights,colour="a"
)
head (gwas)
ls()
ggmanZoom(p1, chromosome = "chr1")
ggmanZoom(p1, chromosome = "chr1")
ggmanZoom(p1, chromosome = "1")
ggmanZoom(p1, chromosome = c(1,2))
ggmanZoom(p1, chromosome = 1,start.position="a")
ggmanZoom(p1, chromosome = 1,start.position=1,end.posiiton = "b")
ggmanZoom(p1, chromosome = 1,start.position=1,end.posiiton = "b")
head(gwas)
ggmanZoom(p1, chromosome = 1,start.position=1,end.posiiton = 100)
ggmanZoom(p1, chromosome = 1,start.position=1,end.posiiton = 100)
ggmanZoom(p1, chromosome = 1,start.position=1,end.position = 100)
ggmanZoom(p1, chromosome = 1,start.position=1,end.position = 100)
p2 = ggmanZoom(p1, chromosome = 1,start.position=1,end.position = 100)
head(gwas.sig)
head(gwa)
head(gwas)
ggmanHighlight(p2,highlight = c("rs1_0_M","rs1_1","rs1_2"))
head(gwas.sig)
head(gwas)
ggplot(gwas[1:100,], aes(BP,P)) + geom_point()
library(ggplot2)
ggplot(gwas[1:100,], aes(BP,P)) + geom_point()
ggplot(gwas[1:100,], aes(BP,P, colour = as.factor(CHR))) + geom_point()
p1 = ggplot(gwas[1:100,], aes(BP,P, colour = as.factor(CHR))) + geom_point()
p1 + ggplot(gwas[1:10,],aes(colour = BP))
p1 + ggplot(gwas[1:10,],aes(colour = as.factor(BP)))+ geom_point()
p1 + ggplot(gwas[1:10,],aes(colour = as.factor(BP)))+ geom_point(da)
p1 + geom_point(data = gwas[1:10,], aes(colour = as.factor(BP)))
p1 = ggplot(gwas[1:100,], aes(BP,P, fill = as.factor(CHR))) + geom_point()
p1 = ggplot(gwas[1:100,], aes(BP,P, fill = as.factor(CHR))) + geom_point() + guides(fill = FALSE)
p1 = ggplot(gwas[1:100,], aes(BP,P, fill = as.factor(CHR))) + geom_point() + guides(fill = FALSE)
p1 + geom_point(data = gwas[1:10,], aes(colour = as.factor(BP)))
p1 + geom_point(data = gwas[1:10,], aes(colour = as.factor(BP))) + scale_fill_grey()
ggman(gwas, bp = "BP", chrom = "CHROM", snp = "SNP", pvalue = "P")
ggman(gwas, bp = "BP", chrom = "CHR", snp = "SNP", pvalue = "P")
ggman(gwas, bp = "BP", chrom = "CHR", snp = "SNP", pvalue = "P")
ggman(gwas, bp = "BP", chrom = "CHR", snp = "SNP", pvalue = "P")
ggman(gwas, bp = "BP", chrom = "CHR", snp = "SNP", pvalue = "P")
ggman(gwas, bp = "BP", chrom = "CHR", snp = "SNP", pvalue = "P")
ggman(gwas, bp = "BP", chrom = "CHR", snp = "SNP", pvalue = "P")
ggman(gwas, bp = "BP", chrom = "CHR", snp = "SNP", pvalue = "P")
ggplot(gwas[1:100,], aes(BP,P, fill = CHR)) + geom_point()
p1 = ggplot(gwas[1:100,], aes(BP,P, fill = CHR)) + geom_point()
p1 + geom_point(data = gwas[1:10,], aes(colour = as.factor(BP)))
p1 + geom_point(data = gwas[1:10,], aes(colour = as.factor(BP))) + scale_fill_grey()
p1 = ggplot(gwas[1:100,], aes(BP,P, fill = as.factor(CHR))) + geom_point()
p1 + geom_point(data = gwas[1:10,], aes(colour = as.factor(BP))) + scale_fill_grey()
p1 + geom_point(data = gwas[1:10,], aes(colour = as.factor(BP))) + scale_fill_grey(start = 0.4,end=0.5)
p1 + geom_point(data = gwas[1:10,], aes(colour = as.factor(BP))) + scale_fill_grey(start = 0.4,end=0.5) + guides(fill=FALSE)
ggman(gwas, bp = "BP", chrom = "CHR", snp = "SNP", pvalue = "P")
ggman(gwas, bp = "BP", chrom = "CHR", snp = "SNP", pvalue = "P")
ggman(gwas, bp = "BP", chrom = "CHR", snp = "SNP", pvalue = "P")
ggman(gwas, bp = "BP", chrom = "CHR", snp = "SNP", pvalue = "P")
ggman(gwas, bp = "BP", chrom = "CHR", snp = "SNP", pvalue = "P")
p1 =ggman(gwas, bp = "BP", chrom = "CHR", snp = "SNP", pvalue = "P")
temp = p1[[1]]
head(temp)
ggplot(temp, aes(bp,pvalue,fill=chrom))+geom_point(size=0.1)
ggplot(temp, aes(bp,-log10(pvalue),fill=chrom))+geom_point(size=0.1)
temp1 =temp[1:100.]
temp1 =temp[1:100,]
ggplot(temp1, aes(bp,-log10(pvalue),fill=chrom))+geom_point(size=0.1)
ggplot(temp1, aes(bp,marker,fill=chrom))+geom_point(size=0.1)
ggplot(temp1, aes(bp,marker,fill=as.factor(chrom)))+geom_point(size=0.1)
ggplot(temp1, aes(bp,marker,fill=as.factor(chrom)))+geom_point(size=0.1) + scale_fill_hue()
ggplot(temp1, aes(bp,marker,fill=as.factor(chrom)))+geom_point() + scale_fill_hue()
ggplot(temp1, aes(bp,marker,fill=as.factor(chrom)))+geom_point() + scale_fill_manual("blue")
ggplot(temp1, aes(bp,marker,fill=as.factor(chrom)))+geom_point() + scale_fill_manual(values = "blue")
ggplot(temp1, aes(bp,marker,fill=BP)+geom_point() + scale_fill_manual(values = "blue")
ggplot(temp1, aes(bp,marker,fill=BP))+geom_point() + scale_fill_manual(values = "blue")
ggplot(temp1, aes(bp,marker,fill=bp))+geom_point() + scale_fill_manual(values = "blue")
ggplot(temp1, aes(bp,marker,fill=bp))+geom_point()
str(temp1)
class(temp1$chrom_alt)
class(temp1$chrom_alt) = "numeric"
ggplot(temp1, aes(bp,marker,fill=chrom_alt))+geom_point()
ggplot(temp, aes(bp,pvalue,fill=chrom))+geom_point(size=0.1)
ggman(gwas, bp = "BP", chrom = "CHR", pvalue = "P", snp = "SNP")
ggman(gwas, bp = "BP", chrom = "CHR", pvalue = "P", snp = "SNP")
ggman(gwas, bp = "BP", chrom = "CHR", pvalue = "P", snp = "SNP")
ggman(gwas, bp = "BP", chrom = "CHR", pvalue = "P", snp = "SNP")
ggman(gwas, bp = "BP", chrom = "CHR", pvalue = "P", snp = "SNP")
ggman(gwas, bp = "BP", chrom = "CHR", pvalue = "P", snp = "SNP")
p1 = ggman(gwas, bp = "BP", chrom = "CHR", pvalue = "P", snp = "SNP")
temp = p1$data
str(temp)
temp1 = temp[1:100,]
ggplot(temp1,aes(index,marker))+geom_point()
ggplot(temp1,aes(index,marker,fill = chrom_alt))+geom_point()
str(temp1)
ggplot(temp1,aes(index,marker,fill = marker))+geom_point()
ggplot(temp1,aes(index,marker,fill = chrom_alt))+geom_point()
temp1$chrom_alt = as.numeric(dfm$chrom_alt)
temp1$chrom_alt = as.numeric(temp1$chrom_alt)
ggplot(temp1,aes(index,marker,fill = chrom_alt))+geom_point()
ggman(gwas, bp = "BP", chrom = "CHR", pvalue = "P", snp = "SNP")
p1 = ggman(gwas, bp = "BP", chrom = "CHR", pvalue = "P", snp = "SNP")
str(p1$data)
temp = p1$data
head(temp)
table(temp$chrom_alt)
ggplot(temp,aes(index,marker, fill = chrom_alt)) + geom_point(size = 0.1)
ggplot(temp,aes(index,marker, fill = chrom_alt)) + geom_point()
ggplot(temp,aes(index,marker, fill = as.factor(chrom_alt))) + geom_point()
temp$nchr = replace(temp$nchr, temp$nchr == 0, "a")
temp$nchr = replace(temp$chrom_alt, temp$chrom_alt== 0, "a")
table(temp$nchr)
temp$nchr = replace(temp$nchr, temp$chrom_alt== 1, "b")
table(temp$nchr)
ggplot(temp,aes(index,marker, fill = as.factor(chrom_alt))) + geom_point()
ggplot(temp,aes(index,marker, fill = as.factor(nchr))) + geom_point()
ggman(gwas, bp = "BP", chrom = "CHR", pvalue = "P", snp = "SNP")
p1 = ggman(gwas, bp = "BP", chrom = "CHR", pvalue = "P", snp = "SNP")
p1 + ggmanHighlight(p1, highlight = highlights)
p1 + ggmanHighlight(p1, highlight = highlights)
head(highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
?scale_fill_continuous
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)

. + Error in base::source(text, local = env, echo = visibly, print.eval = output,  : 
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)

. + 
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
ggmanHighlight(p1, highlight = highlights)
temp = gwas[-log10(gwas$P) > 5,]
nrow(temp)
ggmanHighlight(p1,)
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR")
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR")
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR")
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR")
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR")
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR")
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR")
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR", size = 1)
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR")
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR", alpha =0.1)
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR", size = 1)
?geom_point
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR", size = 2)
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR", size = 2)
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR", size = 2)
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR", pointSize = 2)
p1  =ggman(gwas, bp = "BP", snp ="SNP", pvalue = "P", chrom = "CHR", pointSize = 1)
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR", pointSize = 2)
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR", pointSize = 1)
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR", pointSize = 1) + theme_classic()
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR", pointSize = 1) + theme_classic()
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR", pointSize = 1) + theme_classic()
ggmanHighlight(p1,temp, snp = "SNP",group = "CHR", pointSize = 1) + theme_classic()
ggmanHighlight(p1,highlights)
ggmanHighlight(p1,highlights, size = 0.1)
ggmanHighlight(p1,highlights, size = 0.1)
p1
p1 = ggman(gwas, bp = "BP", chrom = "CHR", pvalue = "P", snp = "SNP")
p1
ggmanHighlight(p1,highlights)
ggmanHighlight(p1,highlights,size=0.1)
ggmanHighlight(p1,highlight,size=0.1)
ggmanHighlight(p1,highlight = "1",size=0.1)
ggmanHighlight(p1,highlight = "1",size=0.1)
a = "a"
ggmanHighlight(a,highlight = "1",size=0.1)
ggmanHighlight(p1,gwas,highlight = "1",size=0.1)
ggmanHighlight(p1,highlight = gwas,size=0.1)
is.vector(gwas)
ggmanHighlight(p1,highlight = "a",size=0.1)
a = list(1,2)
is.vector(a)
a
a = data.frame("a")
a
is.vector(a)
ggmanHighlight(p1,highlight = a,size=0.1)
ggmanHighlight(p1,highlight = gwas,size=0.1)
