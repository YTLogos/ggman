library(ggman)
p1 <- ggman(gwas, snp = "SNP", bp = "BP", chrom = "CHR", pvalue = "P")
p1
ggmanHighlight(p1, highlight = highlights)
head(highlight)
head(highlights)
head(gwas)
highlights
library(ggman)
highlights
load("data/highlights.RData")
highlights
ggmanHighlight
ls()
detach("package:ggman", unload = TRUE)
library(ggman)
library(ggman)
getwd()
setwd("~/MEGA/MEGAsync/GWAS/")
list.files()
library(data.table)
gwas2 <- fread("gwas1.txt")
head(gwas2)
length(grep("rs02",gwas2$SNP))
length(grep("rs0011",gwas2$SNP))
library(data.table)
setwd("~/MEGA/MEGAsync/GWAS/")
gwas1 <- fread("gwas1.txt")
head(gwas1)
library(ggman)
ls()
library(ggman)
check.input.ggman
ls()
check.input.ggman
library(ggman)
head(toy.gwas)
head(toy.highlights)
head(toy.clumped)
head(toy.gwas)
names(toy.gwas) <- c("chrom","snp","bp","pvalue","or","gene")
head(toy.gwas)
toy.gwas$beta = log(toy.gwas$OR)
toy.gwas$beta = log(toy.gwas$or)
head(toy.gwas)
toy.gwas.bk <- toy.gwas[,c(1,2,3,4,7,5,6)]
head(toy.gwas.bk)
toy.gwas <- toy.gwas.bk
head(toy.gwas)
save(toy.gwas,"/Users/veera/Research/myscripts/github/ggman/data/toy.gwas.RData")
save(toy.gwas,file = "/Users/veera/Research/myscripts/github/ggman/data/toy.gwas.RData")
table(toy.gwas$chrom)
temp.split <- split(toy.gwas,toy.gwas$chrom)
head(temp.split[[22]])
head(temp.split[[22]]$pvalue)
temp.split[[22]]$pvalue = temp.split[[2]]$pvalue[1:517]
names(temp.split)
data.frame(names(temp.split))
head(temp.split[[15]]$pvalue)
temp.split[[15]]$pvalue = temp.split[[2]]$pvalue[1:517]
toy.gwas.bk <- do.call(rbind,temp.split)
head(toy.gwas.bk)
tail(toy.gwas.bk)
temp.split[[15]]$pvalue = temp.split[[2]]$pvalue[1:517]
temp.split[[15]]$pvalue = temp.split[[2]]$pvalue[1:517]  C-c C-c
toy.gwas <- toy.gwas.bk
save(toy.gwas,file = "/Users/veera/Research/myscripts/github/ggman/data/toy.gwas.RData")
ls()
head(toy.gwas)
rs02 <- toy.gwas$snp[grep("rs02",toy.gwas$snp)]
head(rs02)
rs06 = toy.gwas$snp[grep("rs06",toy.gwas$snp)]
head(rs06)
toy.highlight.group <- toy.gwas[toy.gwas$snp %in% c(rs06,rs02)]
toy.highlight.group <- toy.gwas[toy.gwas$snp %in% c(rs06,rs02),]
head(toy.highlight.group)
toy.highlight.group$group = with(toy.highlight.group, replace(snp, grep("rs02",snp),"group1"))
toy.highlight.group$group = with(toy.highlight.group, replace(group, grep("rs06",snp),"group2"))
table(toy.highlight.group$grconvertX)
table(toy.highlight.group$group)
head(toy.highlight.group)
toy.highlights.group <- toy.highlight.group
save(toy.highlights.group, file = "/Users/veera/Research/myscripts/github/ggman/data/toy.highlights.group.RData")
head(row.names(toy.gwas))
head(row.names(toy.highlight.group))
row.names(toy.highlight.group) = 1:nrow(toy.highlight.group)
save(toy.highlights.group, file = "/Users/veera/Research/myscripts/github/ggman/data/toy.highlights.group.RData")
library(ggman)
head(toy.highlights.group)
row.names(toy.highlights.group) = 1:nrow(toy.highlights.group)
save(toy.highlights.group, file = "/Users/veera/Research/myscripts/github/ggman/data/toy.highlights.group.RData")
head(toy.gwas)
temp = toy.gwas[toy.gwas$gene %in% c("GENE20","GENE21","GENE23"),]
nrow(temp)
head(temp)
max(temp$bp)
min(temp$bp)
ls()
library(ggman)
ggmanZoom
head(toy.gwas)
head(toy.gwas)
ggman(toy.gwas)
p1 = ggman(toy.gwas)
head(p1$data)
library(ggman)
p1 = ggman(toy.gwas)
head(p1$data)
ggmanZoom(p1, chromosome = 1, start.position = 14209481, end.position = 238131450, highlight.group = "gene")
ggmanZoom(p1, chromosome = 1, start.position = 14209481, end.position = 238131450, highlight.group = "gene")
ggmanZoom(p1, chromosome = 1, start.position = 14209481, end.position = 238131450, highlight.group = "gene")
a = c(1,2,3)
b = c(4,5,6)
ab = list(a,b)
ab
x = "red"
y = "yellow"
xy = list(x,y)
xy
abxy = list(ab,xy)
abxy
length(abxy)
names(abxy)
names(abxy) = c("numbers","colors")
abxy
abxy$numbers
abxy$colors
temp = abxy$numbers
class(temp)
temp
a
a
as.list(a)
a = as.list(a)
class(a)
class(b)
list(a,b)
library(ggman)
temp = ggmanClumps(toy.clumped)
temp = ggmanClumps(toy.clumped, index.snp.column = "SNP", clumps.column = "SP2")
temp
temp = ggmanClumps(toy.clumped, index.snp.column = "SNP", clumps.column = "SP2")
temp
temp
is.na(temp$clump.colors)
ls()
head(gwas)
library(ggman)
head(toy.gwas)
p1 <- ggman(toy.gwas)
head(p1)
dfm <- p1$data
head(dfm)
clumps <- ggmanClumps(toy.clumped)
names(clumps)
head(clump.dfm)
head(clump.dfm)
names(clumps)
head(clumps$clump.snps)
clumps <- ggmanClumps(toy.clumped, clumps.column = "SP2",index.snp.column = "SNP")
clumps$clump.index
head(clump.dfm)
head(clump.dfm)
nrow(clump.dfm)
indexSnps
index.dfm
nrow(dfm.sub)
head(dfm.sub)
nrow(clump.dfm)
head(dfm)
nrow(dfm)
table(dfm$snp %in% dfm.sub$snp)
names(clumps)
names(clumps)
head(toy.gwas)
ggman(toy.gwas)
ggman(toy.gwas, clumps = toy.clumped)
ggman(toy.gwas, clumps = toy.clumped)
clumps <- ggmanClumps(toy.clumped)
ggman(toy.gwas, clumps = clumps)
ggman(toy.gwas, clumps = clumps)
ggman(toy.gwas, clumps = clumps)
ggman(toy.gwas, clumps = clumps)
head(clump.dfm)
ggman(toy.gwas, clumps = clumps)
clumps <- ggmanClumps(toy.clumped, index.snp.column = "SNP", clumps.column = "SP2")
ggman(toy.gwas, clumps = clumps)
class(clump.dfm)
dim(clump.dfm)
head(clump.dfm)
head(clump.dfm)
ggman(toy.gwas, clumps = clumps)
clump.dfm$SNP
clump.dfm$snp
dim(dfm.sub)
head(dfm.sub)
dfm <- dfm[dfm$snp %in% clump.dfm$snp,]
dfm <- dfm[!dfm$snp %in% clump.dfm$snp,]
dim(dfm)
dim(dfm.sub)
ggman(toy.gwas,clumps = clumps)
dim(dfm)
dim(clump.dfm)
dim(dfm)
dim(dfm)
dim(dfm)
head(dfm)
dim(clump.dfm.lst)
dim(clump.dfm)
head(clump.dfm)
dim(dfm)
temp <- dfm[! dfm$snp %in% clump.dfm$snp,]
head(dfm$snp)
head(clump.dfm$snp)
class(clump.dfm)
class(clump.dfm)
ggman(toy.gwas, clumps = clumps)
p1 = ggman(toy.gwas)
dfm <- p1$data
head(index.dfm)
head(index.dfm)
head(clump.dfm)
class(clump.dfm)
head(dfm.sub)
head(dfm.sub)
index.dfm
indexSnps
head(dfm.sub)
table(dfm.sub$snp.x %in% indexSnps)
index.dfm
ggman(toy.gwas, clumps = clumps)
ggman(toy.gwas, clumps = clumps)
head(clump.dfm)
ggman(toy.gwas, clumps = clumps)
rm(list = ls())
ggman(toy.gwas, clumps = clumps)
clumps <- ggmanClumps(toy.clumped, index.snp.column = "SNP", clumps.column = "SP2")
clumps
ggman(toy.gwas,clumps = clumps)
ls()
head(dfm.sub)
ggplot(dfm.sub, aes(index,-log10(pvalue))) + geom_point()
library(ggplot2)
ggplot(dfm.sub, aes(index,-log10(pvalue))) + geom_point()
head(clump.dfm)
ggman(toy.gwas,clumps = clumps)
ggman(toy.gwas,clumps = clumps)
head(dfm)
p1 = ggman(toy.gwas)
head(p1$data)
-log10(0.9142)
ggman(toy.gwas,clumps = clumps)
names(toy.clumped)
toy.clumped[,1]
toy.clumped$group = c("group1","group2")
clumps <- ggmanClumps(toy.clumped, index.snp.column = "SNP", clumps.column = "SP2", group.column = "group")
clumps
ggman(toy.gwas, clumps=clumps)
ggman(toy.gwas, clumps=clumps)
ggman(toy.gwas, clumps=clumps)
ggman(toy.gwas, clumps=clumps)
ggman(toy.gwas, clumps=clumps)
head(dfm.sub)
table(clump.groups)
table(dfm.sub$clump.groups)
ggman(toy.gwas, clumps=clumps)
ls()
head(p1$data)
p1
p1 + geom_point(data=dfm.sub,colour="blue)
p1 + geom_point(data=dfm.sub,colour="blue")
p1 + geom_point(data=dfm.sub,aes(fill=clump.groups)colour="blue")
p1 + geom_point(data=dfm.sub,aes(fill=clump.groups),colour="blue")
p1 + geom_point(data=dfm.sub,aes(fill=clump.groups), shape=21,colour=alpha("black",0))
p1 + geom_point(data=dfm.sub,aes(fill=as.factor(clump.groups)), shape=21,colour=alpha("black",0))
p1 + geom_point(data=dfm.sub,aes(fill=as.factor(clump.groups)), shape=21,colour=alpha("black",0)) 
p1 + geom_point(data=dfm.sub,aes(fill=as.factor(clump.groups)), shape=21,colour=alpha("black",0)) 
p1 + geom_point(data=dfm.sub,aes(fill=as.factor(clump.groups)), shape=21,colour=alpha("black",0)) +
geom_point(data = index.dfm,colour="red")
ls()
ggman(toy.gwas, clumps=clumps)
p1 + geom_point(data=dfm.sub,aes(fill=as.factor(clump.groups)), shape=21,colour=alpha("black",0)) +
geom_point(data = index.dfm,colour="red")
p1 + geom_point(data=dfm.sub,aes(fill=as.factor(clump.groups)), shape=21,colour=alpha("black",0)) +
geom <- point(data = index.dfm,aes(fill = )))
ggman(toy.gwas, clumps=clumps)
ggman(toy.gwas, clumps=clumps,pointSize = 0.5)
ggman(toy.gwas, clumps=clumps,pointSize = 1)
ggman(toy.gwas, clumps=clumps,pointSize = 1)
ggman(toy.gwas, clumps=clumps,pointSize = 1)
dim(toy.clumped)
toy.clumped$label <- c("GENE1","GENE2")
clumps <- ggmanClumps(toy.clumped, index.snp.column="SNP", clumps.column = "SP2", label.column = "label", group.column = "group")
ggman(toy.gwas, clumps=clumps,pointSize = 1)
ggman(toy.gwas, clumps=clumps,pointSize = 1)
ggman(toy.gwas, clumps=clumps,pointSize = 1)
ggman(toy.gwas, clumps=clumps,pointSize = 1)
ggman(toy.gwas, clumps=clumps,pointSize = 1)
